<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bangla sheba commety</title>

<style>
    body{
        font-family: Arial;
        padding: 10px;
        background:#f4f4f4;
    }
  .container{max-width:1000px;margin:18px auto;padding:16px}
  
    h1{
        text-align:center;
        margin-bottom:20px;
    }

    .top-buttons{
        display:flex;
        gap:10px;
        margin-bottom:20px;
    }
    button{
        padding:10px 20px;
        background:#3498db;
        color:#fff;
        border:none;
        border-radius:5px;
        cursor:pointer;
        font-size:16px;
    }
    button:hover{
        background:#2980b9;
    }

    .search-bar{
        width:100%;
        padding:10px;
        margin-bottom:20px;
        font-size:16px;
    }

    table{
        width:100%;
        border-collapse: collapse;
        background:white;
    }
    th, td{
        border:1px solid #ddd;
        padding:10px;
        text-align:left;
    }
    th{
        background:#3498db;
        color:white;
    }

    .hidden {
        display:none;
    }
  
  /* Modal */
    .modal {display:none; position:fixed; top:0; left:0; width:70%; height:90%; background:rgba(0,0,0,0.6); justify-content:center; align-items:center;}
    .modal-content {background:white; padding:20px; border-radius:10px; width:90%; max-width:700px;}
    .modal-content input, textarea, select {width:100%; margin-bottom:10px; padding:8px; border:1px solid #ccc; border-radius:5px;}
    .close {float:right; cursor:pointer; color:red;}
  
</style>
</head>

<body>

<h1>Bangla sheba commety</h1>

<!-- TOP BUTTONS -->
<div class="top-buttons">
    <button onclick="showTotalDonation()">Total </button>
    <button onclick="showAddressCount()">Address</button>
    <button onclick="showCategoryCount()">category</button>
    <button onclick="showPositionCount()">position</button>
</div>
 <button class="donate-btn" onclick="openDonateForm()">Add worker</button>
  
  <!-- Donate Form Modal -->
  <div id="donateModal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeDonateForm()">close</span>
      <h3>Add worker form</h3>
      <input type="text" id="dPname" placeholder=" full name">
      <select id="dAddress" required>
        <option value="">ржПрж░рж┐рзЯрж╛ ржирж┐рж░рзНржмрж╛ржЪржи</option>
         <option>ржмрж╛ржВрж▓рж╛ржжрзЗрж╢</option>
        <option>ржЪржЯрзНржЯржЧрзНрж░рж╛ржо</option>
  <option>ржХржХрзНрж╕ржмрж╛ржЬрж╛рж░</option>
  <option>ржмрж╛ржирзНржжрж░ржмрж╛ржи</option>
  <option>рж░рж╛ржЩрзНржЧрж╛ржорж╛ржЯрж┐</option>
  <option>ржЦрж╛ржЧрзЬрж╛ржЫрзЬрж┐</option>
  <option>ржлрзЗржирзА</option>
  <option>ржирзЛржпрж╝рж╛ржЦрж╛рж▓рзА</option>
  <option>рж▓ржХрзНрж╖рзНржорзАржкрзБрж░</option>
  <option>ржЪрж╛ржБржжржкрзБрж░</option>
  <option>ржХрзБржорж┐рж▓рзНрж▓рж╛</option>
  <option>ржмрзНрж░рж╛рж╣рзНржоржгржмрж╛ржбрж╝рж┐ржпрж╝рж╛</option>
    
    
    <option>ржврж╛ржХрж╛</option>
  <option>ржЧрж╛ржЬрзАржкрзБрж░</option>
  <option>ржХрж┐рж╢рзЛрж░ржЧржЮрзНржЬ</option>
  <option>ржорж╛ржирж┐ржХржЧржЮрзНржЬ</option>
  <option>ржорзБржирзНрж╕рзАржЧржЮрзНржЬ</option>
  <option>ржирж╛рж░рж╛ржпрж╝ржгржЧржЮрзНржЬ</option>
  <option>ржирж░рж╕рж┐ржВржжрзА</option>
  <option>ржлрж░рж┐ржжржкрзБрж░</option>
  <option>ржЧрзЛржкрж╛рж▓ржЧржЮрзНржЬ</option>
  <option>ржорж╛ржжрж╛рж░рзАржкрзБрж░</option>
  <option>рж░рж╛ржЬржмрж╛ржбрж╝рзА</option>
  <option>рж╢рж░рзАржпрж╝рждржкрзБрж░</option> 
    
    <option>ржмрж░ржЧрзБржирж╛</option>
  <option>ржмрж░рж┐рж╢рж╛рж▓</option>
  <option>ржнрзЛрж▓рж╛</option>
  <option>ржЭрж╛рж▓ржХрж╛ржарж┐</option>
  <option>ржкржЯрзБржпрж╝рж╛ржЦрж╛рж▓рзА</option>
  <option>ржкрж┐рж░рзЛржЬржкрзБрж░</option>

  <option>ржмржЧрзБржбрж╝рж╛</option>
  <option>ржЬржпрж╝ржкрзБрж░рж╣рж╛ржЯ</option>
  <option>ржиржУржЧрж╛ржБ</option>
  <option>ржирж╛ржЯрзЛрж░</option>
  <option>ржЪрж╛ржБржкрж╛ржЗржиржмрж╛ржмржЧржЮрзНржЬ</option>
  <option>ржкрж╛ржмржирж╛</option>
  <option>рж╕рж┐рж░рж╛ржЬржЧржЮрзНржЬ</option>
 

  <option>ржЦрзБрж▓ржирж╛</option>
  <option>ржмрж╛ржЧрзЗрж░рж╣рж╛ржЯ</option>
  <option>ржЪрзБржпрж╝рж╛ржбрж╛ржЩрзНржЧрж╛</option>
  <option>ржпрж╢рзЛрж░</option>
  <option>ржЭрж┐ржирж╛ржЗржжрж╣</option>
  <option>ржХрзБрж╖рзНржЯрж┐ржпрж╝рж╛</option>
  <option>ржорж╛ржЧрзБрж░рж╛</option>
  <option>ржорзЗрж╣рзЗрж░ржкрзБрж░</option>
  <option>ржиржбрж╝рж╛ржЗрж▓</option>
  <option>рж╕рж╛рждржХрзНрж╖рзАрж░рж╛</option>

  <option>ржоржпрж╝ржоржирж╕рж┐ржВрж╣</option>
  <option>ржирзЗрждрзНрж░ржХрзЛржирж╛</option>
  <option>ржЬрж╛ржорж╛рж▓ржкрзБрж░</option>
  <option>рж╢рзЗрж░ржкрзБрж░</option>

  <option>рж░рж╛ржЬрж╢рж╛рж╣рзА</option>
  <option>ржЪрж╛ржБржкрж╛ржЗржиржмрж╛ржмржЧржЮрзНржЬ</option>
  <option>ржиржУржЧрж╛ржБ</option>
  <option>ржирж╛ржЯрзЛрж░</option>
  <option>ржкрж╛ржмржирж╛</option>
  <option>ржмржЧрзБржбрж╝рж╛</option>
  <option>ржЬржпрж╝ржкрзБрж░рж╣рж╛ржЯ</option>
  <option>рж╕рж┐рж░рж╛ржЬржЧржЮрзНржЬ</option>

  <option>рж░ржВржкрзБрж░</option>
  <option>ржжрж┐ржирж╛ржЬржкрзБрж░</option>
  <option>ржЧрж╛ржЗржмрж╛ржирзНржзрж╛</option>
  <option>ржХрзБржбрж╝рж┐ржЧрзНрж░рж╛ржо</option>
  <option>рж▓рж╛рж▓ржоржирж┐рж░рж╣рж╛ржЯ</option>
  <option>ржирзАрж▓ржлрж╛ржорж╛рж░рзА</option>
  <option>ржкржЮрзНржЪржЧржбрж╝</option>
  <option>ржарж╛ржХрзБрж░ржЧрж╛ржБржУ</option>

  <option>рж╕рж┐рж▓рзЗржЯ</option>
  <option>ржорзМрж▓ржнрзАржмрж╛ржЬрж╛рж░</option>
  <option>рж╣ржмрж┐ржЧржЮрзНржЬ</option>
  <option>рж╕рзБржирж╛ржоржЧржЮрзНржЬ</option>
      </select>
      
      
<select id="dCategory" required>
        <option value="">ржХрж╛ржЬрзЗрж░ ржХрзЗржЯрж╛ржЧрж░рж┐</option>
        <option>ржХрзЗржирж╛ржХрж╛ржЯрж╛</option>
        <option>рж╢рж┐ржХрзНрж╖рж╛</option>
        <option>ржЪрж┐ржХрж┐рждрж╕рж╛</option>
        <option>ржбрж┐ржЬрж┐ржЯрж╛рж▓</option>
        <option>рж╕ржорж╛ржЬрж┐ржХ</option>
        <option>ржХрзГрж╖рж┐</option>
      </select>
        
        <select id="dPosition" required>
        <option value="">ржХрж╛ржЬрзЗрж░ рж▓рзЗржнрзЗрж▓</option>
        <option>ржкрж░рж┐ржЪрж╛рж▓ржХ</option>
        <option>рж╕рж╣ржХрж╛рж░рж┐ ржкрж░рж┐ржЪрж╛рж▓ржХ</option>
       
      </select>
        
      <input type="text" id="dCode" placeholder="code 6 digit">
      <input type="mail" id="dEmail" placeholder="email">
      <textarea id="dDescription" placeholder="description"></textarea>
      <input type="text" id="dWhatsapp" placeholder="WhatsAp 880">
      <input type="text" id="dImage" placeholder="image">
      <button onclick="submitDonate()">submit</button>
    </div>
  </div>
  
  
<!-- SEARCH BAR -->
<input type="text" id="searchBox" class="search-bar" placeholder=" рж╕рж╛рж░рзНржЪ ржХрж░рзБржитАж" onkeyup="searchTable()">

<!-- DATA TABLE -->
<table id="dataTable">
    <thead>
        <tr>
            <th>TimeStamp</th>
            <th>Name</th>
            <th>Address</th>
            <th>Whatsapp</th>
            <th>Category</th>
            <th>position</th>
            <th>Code</th>
          <th>Email</th>
            <th>Description</th>
            <th>Image</th>
        </tr>
    </thead>
    <tbody id="tableBody"></tbody>
</table>


<script>
// ЁЯЯж Google Sheet тЖТ OpenSheet API URL
const sheetURL = "https://opensheet.elk.sh/1wEzdJn1nNH4LO3Z77mviGrA6m7m8-rac_xnKbyxBuI0/Sheet1";

// ЁЯЯж Load Data
fetch(sheetURL)
.then(res => res.json())
.then(data => {
    loadTable(data);
    window.dataset = data;   // store for button stats
});

// ЁЯЯж Load data into table
function loadTable(data){
    const tbody = document.getElementById("tableBody");
    tbody.innerHTML = "";

    data.forEach(row => {
        let tr = document.createElement("tr");

        tr.innerHTML = `
            <td>${row.TimeStamp}</td>
            <td>${row.Pname}</td>
            <td>${row.Address}</td>

            <td><a href="https://wa.me/${row.Whatsapp}" target="_blank">${row.Whatsapp}</a></td>

            <td>${row.Category}</td>
            <td>${row.Position}</td>
            <td>${row.Code}</td>
            <td><button onclick="sendMail('${row.Email}')">Mail</button></td>

            <td>
                <button onclick="alert('${row.Description.replace(/'/g, "\\'")}')">Show</button>
            </td>
          

            <td>
                <button onclick="window.open('${row.Image}', '_blank')">View</button>
            </td>
        `;

        tbody.appendChild(tr);
    });
}

  function sendMail(email){
    window.location.href = `mailto:${email}`;
}

function openLink(url){
    window.open(url, "_blank");
}
  

// ЁЯЯж Search Function
function searchTable(){
    let filter = document.getElementById("searchBox").value.toLowerCase();
    let trs = document.getElementById("dataTable").getElementsByTagName("tr");

    for(let i=1; i<trs.length; i++){
        let rowText = trs[i].innerText.toLowerCase();
        trs[i].style.display = rowText.includes(filter) ? "" : "none";
    }
}


// ЁЯЯж Total Donation Count
function showTotalDonation(){
    alert("Total people: " + window.dataset.length);
}


// ЁЯЯж Address Count
function showAddressCount(){
    let count = {};

    window.dataset.forEach(d => {
        if(!count[d.Address]) count[d.Address] = 0;
        count[d.Address]++;
    });

    let msg = "Address count:\n\n";
    for(let a in count){
        msg += `${a}: ${count[a]} people\n`;
    }

    alert(msg);
}


// ЁЯЯж Category Count
function showCategoryCount(){
    let count = {};

    window.dataset.forEach(d => {
        if(!count[d.Category]) count[d.Category] = 0;
        count[d.Category]++;
    });

    let msg = "Category count :\n\n";
    for(let c in count){
        msg += `${c}: ${count[c]} people\n`;
    }

    alert(msg);
}
// ЁЯЯж position Count
function showPositionCount(){
    let count = {};

    window.dataset.forEach(d => {
        if(!count[d.Position]) count[d.Position] = 0;
        count[d.Position]++;
    });

    let msg = "Position count :\n\n";
    for(let c in count){
        msg += `${c}: ${count[c]} people\n`;
    }

    alert(msg);
}
    
  // Donate Form
    function openDonateForm(){document.getElementById("donateModal").style.display="flex";}
    function closeDonateForm(){document.getElementById("donateModal").style.display="none";}
    function submitDonate(){
      const d={Pname:dPname.value,Address:dAddress.value,Whatsapp:dWhatsapp.value,Category:dCategory.value,Position:dPosition.value,Code:dCode.value,Email:dEmail.value,Description:dDescription.value,Image:dImage.value};
      fetch("https://script.google.com/macros/s/AKfycby1trE42BzvijCpbZ_qdmpsx1wcrDPInDldyBsYK-UOrwSGoICupoRtH2j3JUjY_asr/exec",{method:"POST",body:JSON.stringify(d)})
      .then(()=>{alert("Add worker successully done ");closeDonateForm();});
    }
  
</script>

</body>
</html>
